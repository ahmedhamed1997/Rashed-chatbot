<!DOCTYPE html>
<html data-wf-domain="www.kalam.cx" data-wf-page="6859e561b390be3591aa28ed" data-wf-site="630a788660046f847b0a16cc" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Ask Kalam</title>
<meta content="Ask Kalam" property="og:title">
<meta content="Ask Kalam" property="twitter:title">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="google-site-verification=EwiYR1gVFg5WFVE7c9EWbOZQW-W1m_rwpsn6hOocLuQ" name="google-site-verification">

<!-- External CSS -->
<link href="./Ask Kalam_files/kalamcx.webflow.shared.ffbe31c97.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/" rel="preconnect">
<link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin="anonymous">

<script src="./Ask Kalam_files/webfont.js.download" type="text/javascript"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Great+Vibes:400|Poppins:100,100italic,200,200italic,300,300italic,regular,italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic" media="all">

<script type="text/javascript">
WebFont.load({
  google: {
    families: ["Great Vibes:400","Poppins:100,100italic,200,200italic,300,300italic,regular,italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic"]
  }
});
</script>

<script type="text/javascript">
!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);
</script>

<link href="https://cdn.prod.website-files.com/630a788660046f847b0a16cc/664bfad2af98ed662a161420_Untitled-3.jpg" rel="shortcut icon" type="image/x-icon">
<link href="https://cdn.prod.website-files.com/630a788660046f847b0a16cc/664bfad771e71c882ab4fc9f_Untitled-4.jpg" rel="apple-touch-icon">

<style>
.typed-cursor {
  display: none;
}

/* Reset and base styles for chatbot content */
.gpt_content-text-answer {
  white-space: normal !important;
  overflow-wrap: break-word !important;
  line-height: 1.6 !important;
  font-size: inherit !important;
  color: inherit !important;
  font-family: inherit !important;
  margin: 0 !important;
  padding: 0 !important;
  text-align: left !important;
}

.gpt_content-text-answer * {
  max-width: 100% !important;
  box-sizing: border-box !important;
}

.gpt_content-text-answer a {
  display: block !important;
  background-color: #5e4fff !important;
  color: white !important;
  padding: 12px 20px !important;
  border-radius: 8px !important;
  text-decoration: none !important;
  margin: 16px 0 !important;
  font-weight: 500 !important;
  font-size: 0.9em !important;
  transition: all 0.2s ease !important;
  border: none !important;
  width: fit-content !important;
  max-width: 100% !important;
  cursor: pointer !important;
}

.gpt_content-text-answer a:hover {
  background-color: #372cc9 !important;
  transform: translateY(-1px) !important;
}

.gpt_content-text-answer p {
  margin: 12px 0 !important;
  line-height: 1.6 !important;
  padding: 0 !important;
}

.gpt_content-text-answer ul {
  padding-left: 20px !important;
  margin: 12px 0 !important;
  list-style-position: outside !important;
}

.gpt_content-text-answer ol {
  padding-left: 20px !important;
  margin: 12px 0 !important;
  list-style-position: outside !important;
}

.gpt_content-text-answer li {
  margin: 6px 0 !important;
  line-height: 1.5 !important;
}

.gpt_content-text-answer h1,
.gpt_content-text-answer h2,
.gpt_content-text-answer h3,
.gpt_content-text-answer h4,
.gpt_content-text-answer h5,
.gpt_content-text-answer h6 {
  margin: 16px 0 8px 0 !important;
  font-weight: 600 !important;
  line-height: 1.3 !important;
}

.gpt_content-text-answer strong {
  font-weight: 600 !important;
}

.gpt_content-text-answer em {
  font-style: italic !important;
}

.gpt_content-text-answer blockquote {
  border-left: 4px solid #e0e0e0 !important;
  padding: 12px 16px !important;
  margin: 16px 0 !important;
  color: #666 !important;
  font-style: italic !important;
  background-color: #f9f9f9 !important;
  border-radius: 4px !important;
}

.gpt_content-text-answer code {
  background-color: #f4f4f4 !important;
  padding: 2px 6px !important;
  border-radius: 4px !important;
  font-family: 'Courier New', monospace !important;
  font-size: 0.9em !important;
}

.gpt_content-text-answer pre {
  background-color: #f4f4f4 !important;
  padding: 12px !important;
  border-radius: 6px !important;
  overflow-x: auto !important;
  margin: 12px 0 !important;
}

.gpt_content-line {
  animation: slideUp 0.4s ease;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.gpt_content-answer {
  scrollbar-width: none;
  -ms-overflow-style: none;
  overflow-y: scroll;
}

.gpt_content-answer::-webkit-scrollbar {
  display: none;
}
</style>
</head>

<body>
<div class="page-wrapper">
<div class="global-styles w-embed">
<style>
.w-richtext>:first-child {
  margin-top: 0;
}

.w-richtext>:last-child, .w-richtext ol li:last-child, .w-richtext ul li:last-child {
  margin-bottom: 0;
}

.clickable-off {
  pointer-events: none;
}

.clickable-on {
  pointer-events: auto;
}

.div-square::after {
  content: "";
  display: block;
  padding-bottom: 100%;
}

main:focus-visible {
  outline: -webkit-focus-ring-color auto 0px;
}

.container-medium, .container-small, .container-large {
  margin-right: auto !important;
  margin-left: auto !important;
}

a {
  color: inherit;
  text-decoration: inherit;
  font-size: inherit;
}

.text-style-3lines {
  display: -webkit-box;
  overflow: hidden;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
}

.text-style-2lines {
  display: -webkit-box;
  overflow: hidden;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}
</style>
</div>

<div class="main-wrapper">
<div class="section_gpt">
<div data-animation="default" class="gpt_nav w-nav" data-easing2="ease" data-easing="ease" data-collapse="medium" role="banner" data-duration="400">
<div class="gpt_nav-tablet">
<div class="navbar1_menu-button w-nav-button" aria-label="menu" role="button" tabindex="0" aria-haspopup="menu" aria-expanded="false">
<div class="menu-icon1">
<div class="menu-icon1_line-top"></div>
<div class="menu-icon1_line-middle"><div class="menu-icon_line-middle-inner"></div></div>
<div class="menu-icon1_line-bottom"></div>
</div>
</div>
<a href="#" aria-label="Refresh Page" class="gpt_nav-tablet-link w-inline-block">
<div class="icon-1x1-medium w-embed">
<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="100%" height="100%" viewBox="0 0 24 24">
<path fill="currentColor" d="M19 12.998h-6v6h-2v-6H5v-2h6v-6h2v6h6z"></path>
</svg>
</div>
</a>
</div>

<nav role="navigation" class="gpt_nav-menu w-nav-menu">
<div class="gpt_nav-menu-content">
<div class="gpt_nav_content-top">
<a href="#" class="gpt_nav_new-chat w-inline-block">
<div class="icon-1x1-semimedium w-embed">
<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="100%" height="100%" viewBox="0 0 24 24">
<path fill="currentColor" d="M19 12.998h-6v6h-2v-6H5v-2h6v-6h2v6h6z"></path>
</svg>
</div>
<div>New chat</div>
</a>

<div class="gpt_nav_conversation">
<div class="icon-1x1-semimedium w-embed">
<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="100%" height="100%" viewBox="0 0 24 24">
<path fill="currentColor" d="M20 2H4c-1.103 0-2 .897-2 2v18l5.333-4H20c1.103 0 2-.897 2-2V4c0-1.103-.897-2-2-2zm0 14H6.667L4 18V4h16v12z"></path>
</svg>
</div>
<div class="gpt_nav_conversation-content">
<div class="gpt_nav_conversation-content-text">Conversation</div>
</div>
<a href="#" aria-label="refresh page" class="gpt_nav_delete-chat w-inline-block">
<div class="icon-1x1-semimedium w-embed">
<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="100%" height="100%" viewBox="0 0 24 24">
<path fill="currentColor" d="M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z"></path>
</svg>
</div>
</a>
</div>
</div>

<div class="gpt_nav_content-bottom">
<div class="line-divider"></div>
<a href="https://www.kalam.cx/help" target="_blank" class="gpt_nav_link no-border w-inline-block">
<div class="icon-wrapper is-small">
<img src="https://cdn.prod.website-files.com/630a788660046f847b0a16cc/686d16bbb0b4ea76c5d232b4_question.avif" loading="lazy" alt="">
</div>
<div>Help Center</div>
</a>
<a href="https://www.kalam.cx/careers" target="_blank" class="gpt_nav_link no-border w-inline-block">
<div class="icon-wrapper is-small">
<img src="https://cdn.prod.website-files.com/630a788660046f847b0a16cc/685b2f81a9768d4112205180_Careers.avif" loading="lazy" alt="">
</div>
<div>Careers</div>
</a>
<a href="https://www.kalam.cx/pulse" target="_blank" class="gpt_nav_link no-border w-inline-block">
<div class="icon-wrapper is-small">
<img src="https://cdn.prod.website-files.com/630a788660046f847b0a16cc/686d164de958ad66e63d98ad_blogger.avif" loading="lazy" alt="">
</div>
<div>Kalam Pulse</div>
</a>
<a href="https://www.kalam.cx/connect" target="_blank" class="gpt_nav_link no-border w-inline-block">
<div class="icon-wrapper is-small">
<img src="https://cdn.prod.website-files.com/630a788660046f847b0a16cc/686d166e28837773c90e9328_magazine.avif" loading="lazy" alt="">
</div>
<div>Kalam Connect</div>
</a>
<a href="https://www.kalam.cx/contact" target="_blank" class="gpt_nav_link no-border w-inline-block">
<div class="icon-wrapper is-small">
<img src="https://cdn.prod.website-files.com/630a788660046f847b0a16cc/686d16929c1841301da8534d_contacts.avif" loading="lazy" alt="">
</div>
<div>Contact</div>
</a>
<a href="https://www.kalam.cx/" target="_blank" class="gpt_nav_link no-border home w-inline-block">
<div class="icon-wrapper is-small">
<img src="https://cdn.prod.website-files.com/630a788660046f847b0a16cc/66d6172266a0788dc6a688c5_left-arrow%20(1).png" loading="lazy" alt="kalam left arrow white">
</div>
<div>Return Home</div>
</a>
</div>
</div>
</nav>
<div class="w-nav-overlay" data-wf-ignore=""></div>
</div>

<div class="gpt_component">
<div class="gpt_content-top">
<div class="gpt_home-content">
<div class="div-block-639">
<div class="title is-ask">Ask Kalam<span class="text-span-7"><sup> </sup></span></div>
<p>Your AI Assistant for everything you need to learn about kalam</p>
</div>

<div class="gpt_suggested-questions">
<div class="gpt_home-content_table-item hide-mobile-landscape">
<a href="#" class="gpt_suggestion w-inline-block">
<div class="icon-wrapper is-small">
<img src="https://cdn.prod.website-files.com/630a788660046f847b0a16cc/685b2f814d0c02fd85e3cd86_Sales.avif" loading="lazy" alt="">
</div>
<div>New Client Support</div>
</a>
<a href="#" class="gpt_suggestion w-inline-block">
<div class="icon-wrapper is-small">
<img src="https://cdn.prod.website-files.com/630a788660046f847b0a16cc/685b2f81a9768d4112205180_Careers.avif" loading="lazy" alt="">
</div>
<div>Careers &amp; HR Support</div>
</a>
<a href="#" class="gpt_suggestion w-inline-block">
<div class="icon-wrapper is-small">
<img src="https://cdn.prod.website-files.com/630a788660046f847b0a16cc/685b2f811c26b887d938c5d4_Clients.avif" loading="lazy" alt="">
</div>
<div>Client Relations Support</div>
</a>
<a href="#" class="gpt_suggestion w-inline-block">
<div class="icon-wrapper is-small">
<img src="https://cdn.prod.website-files.com/630a788660046f847b0a16cc/685b2f816336e59ec3f0152d_existing.avif" loading="lazy" alt="">
</div>
<div>Operations Support</div>
</a>
<a href="#" class="gpt_suggestion w-inline-block">
<div class="icon-wrapper is-small">
<img src="https://cdn.prod.website-files.com/630a788660046f847b0a16cc/685b2f8183240bba6a8cadd8_training.avif" loading="lazy" alt="">
</div>
<div>Training Support</div>
</a>
</div>
</div>
</div>
</div>

<div class="gpt_content-answer">
<div class="gpt_content-line is-user hide">
<div class="gpt_content-wrapper">
<div class="user-avatar"></div>
<div class="gpt_content-text"></div>
</div>
</div>

<div class="gpt_content-line is-bot hide">
<div class="gpt_content-wrapper">
<div class="gpt_content-text">
<div class="gpt_content-text-answer w-richtext">
<h2>Webflow GPT</h2>
</div>
</div>
</div>
</div>
</div>

<div class="gpt_content-bottom">
<div fs-formsubmit-reset="true" fs-formsubmit-element="form" class="gpt_form-block w-form">
<form id="wf-form-Question" name="wf-form-Question" data-name="Question" method="get" class="gpt_form" aria-label="Question">
<div class="gpt_input-wrapper">
<input class="gpt_input w-input" maxlength="256" name="Question" data-name="Question" placeholder="" type="text" id="Question">
<input type="submit" data-wait="" class="gpt_submit-button w-button" value="">
<a href="#" class="gpt_stop-icon w-button"></a>
</div>
</form>
<div class="hide w-form-done" tabindex="-1" role="region" aria-label="Question success"></div>
<div class="gpt_form-fail hide w-form-fail" tabindex="-1" role="region" aria-label="Question failure"></div>
</div>
</div>
</div>
</div>
</div>
</div>

<script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=630a788660046f847b0a16cc" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="./ask kalam_files/webflow.1df15f7f89a74d85876a95c906956e81.js.download" type="text/javascript"></script>

<!-- Required Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.6/purify.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.10.2/lottie.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<script>
  const N8N_WEBHOOK = "https://n8n.srv1026521.hstgr.cloud/webhook/37388fd5-4a3f-4840-b071-e34b3b9c3388/chat";

  // Session ID Management
  function generateSessionId() {
    return 'session_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
  }

  function getSessionId() {
    let sessionId = getCookie('chatbot_session_id');
    if (!sessionId) {
      sessionId = generateSessionId();
      setCookie('chatbot_session_id', sessionId, 7);
      console.log('üÜï New session created:', sessionId);
    } else {
      console.log('‚ôªÔ∏è Existing session found:', sessionId);
    }
    return sessionId;
  }

  function setCookie(name, value, days) {
    const expires = new Date();
    expires.setTime(expires.getTime() + (days * 86400000));
    document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/;SameSite=Lax`;
  }

  function getCookie(name) {
    const nameEQ = name + "=";
    const ca = document.cookie.split(';');
    for (let i = 0; i < ca.length; i++) {
      let c = ca[i].trim();
      if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length);
    }
    return null;
  }

  function clearSession() {
    document.cookie = 'chatbot_session_id=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
    console.log('üóëÔ∏è Session cleared');
  }

  document.addEventListener("DOMContentLoaded", () => {
    // ‚úÖ Read user metadata from URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    const userMetadata = {
      signed_in: urlParams.get('signed_in') === 'true',
      name: urlParams.get('name') || '',
      email: urlParams.get('email') || '',
      company: urlParams.get('company') || '',
      job_title: urlParams.get('job_title') || ''
    };

    console.log('üë§ User metadata received:', userMetadata);
    window.userMetadata = userMetadata;

    const form = document.querySelector(".gpt_form-block");
    const input = document.querySelector(".gpt_input");
    const chatCont = document.querySelector(".gpt_content-answer");
    const suggested = document.querySelector(".gpt_suggested-questions");
    const newChatBtn = document.querySelector(".gpt_nav_new-chat");
    const deleteChatBtn = document.querySelector(".gpt_nav_delete-chat");
    const stopBtn = document.querySelector(".gpt_stop-icon");
    const navConversation = document.querySelector(".gpt_nav_conversation");
    const topContent = document.querySelector(".gpt_content-top");

    let isFirstSubmit = true;
    let isBotTyping = false;
    let currentSessionId = getSessionId();

    // ‚úÖ Show personalized greeting if user is signed in
    if (userMetadata.signed_in && userMetadata.name) {
      const greeting = document.querySelector('.div-block-639 p');
      if (greeting) {
        greeting.textContent = `Welcome back, ${userMetadata.name}! How can I help you today?`;
      }
    }

    if (!form || !input || !chatCont) {
      console.error("‚ùå Required elements not found!");
      return;
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      if (isBotTyping) return;

      const text = input.value.trim();
      if (!text) return;

      appendMessage("user", text);

      input.value = "...";
      input.disabled = true;
      isBotTyping = true;
      if (stopBtn) stopBtn.style.display = "block";

      if (isFirstSubmit) {
        if (topContent) topContent.style.display = "none";
        chatCont.style.display = "flex";
        if (navConversation) navConversation.style.display = "flex";
        if (suggested) suggested.style.display = "none";
        isFirstSubmit = false;
      }

      showThinking();

      try {
        // ‚úÖ Include user metadata in the request
        const response = await fetch(N8N_WEBHOOK, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Accept": "application/json"
          },
          body: JSON.stringify({
            message: text,
            sessionId: currentSessionId,
            metadata: window.userMetadata
          }),
          mode: "cors"
        });

        console.log("‚úÖ Response status:", response.status);
        console.log("üìã Sent session ID:", currentSessionId);
        console.log("üë§ Sent metadata:", window.userMetadata);

        const data = await response.json();
        console.log("‚úÖ Response JSON:", data);

        removeThinking();

        const botReply = data.output || "‚ö†Ô∏è No response received.";
        appendMessage("assistant", botReply);

      } catch (err) {
        console.error("‚ùå Error:", err);
        removeThinking();
        appendMessage("assistant", "Sorry, we had a connection problem. Could you please repeat that?");
      } finally {
        input.value = "";
        input.disabled = false;
        isBotTyping = false;
        if (stopBtn) stopBtn.style.display = "none";
      }
    });

    function appendMessage(role, text) {
      const isBot = role === "assistant";
      const line = document.createElement("div");
      line.classList.add("gpt_content-line", isBot ? "is-bot" : "is-user", "fade-slide");

      const wrapper = document.createElement("div");
      wrapper.classList.add("gpt_content-wrapper");
      line.appendChild(wrapper);

      const avatar = document.createElement("div");
      avatar.classList.add("gpt_image", isBot ? "bot-avatar" : "user-avatar");
      wrapper.appendChild(avatar);

      const textEl = document.createElement("div");
      textEl.classList.add("gpt_content-text");
      if (isBot) textEl.classList.add("gpt_content-text-answer");

      if (typeof marked !== 'undefined') {
        const html = marked.parse(text, { breaks: true });
        textEl.innerHTML = DOMPurify.sanitize(html);

        textEl.querySelectorAll('a').forEach((a) => {
          a.setAttribute('target', '_blank');
          a.setAttribute('rel', 'noopener noreferrer');
        });
      } else {
        textEl.textContent = text;
      }

      wrapper.appendChild(textEl);
      chatCont.appendChild(line);
      chatCont.scrollTop = chatCont.scrollHeight;
    }

    function showThinking() {
      const line = document.createElement("div");
      line.classList.add("gpt_content-line", "is-bot", "fade-slide");
      line.id = "thinking-line";

      const wrapper = document.createElement("div");
      wrapper.classList.add("gpt_content-wrapper");
      line.appendChild(wrapper);

      const avatar = document.createElement("div");
      avatar.classList.add("gpt_image", "bot-avatar");

      const lottieContainer = document.createElement("div");
      lottieContainer.id = "lottie-thinking";
      lottieContainer.style.width = "40px";
      lottieContainer.style.height = "40px";
      avatar.appendChild(lottieContainer);
      wrapper.appendChild(avatar);

      const text = document.createElement("div");
      text.classList.add("gpt_content-text", "gpt_content-text-answer");
      text.textContent = "Thinking...";
      wrapper.appendChild(text);

      chatCont.appendChild(line);
      chatCont.scrollTop = chatCont.scrollHeight;

      if (typeof lottie !== 'undefined') {
        lottie.loadAnimation({
          container: lottieContainer,
          renderer: "svg",
          loop: true,
          autoplay: true,
          path: "https://cdn.prod.website-files.com/630a788660046f847b0a16cc/685a222d4f1c3f77aa53b31c_Animation%20-%201750737370654.json"
        });
      }
    }

    function removeThinking() {
      const el = document.getElementById("thinking-line");
      if (el) el.remove();
    }

    if (stopBtn) {
      stopBtn.addEventListener("click", () => {
        console.log("üõë Stop clicked");
        isBotTyping = false;
        input.disabled = false;
        input.value = "";
        stopBtn.style.display = "none";
        removeThinking();
      });
    }

    const suggestionButtons = document.querySelectorAll(".gpt_suggestion");
    suggestionButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        if (isBotTyping) return;
        input.value = btn.textContent;
        form.dispatchEvent(new Event("submit"));
      });
    });

    if (newChatBtn) {
      newChatBtn.addEventListener("click", () => {
        console.log("üÜï New chat");
        clearSession();
        currentSessionId = getSessionId();
        chatCont.innerHTML = "";
        if (topContent) topContent.style.display = "block";
        chatCont.style.display = "none";
        if (navConversation) navConversation.style.display = "none";
        if (suggested) suggested.style.display = "flex";
        input.disabled = false;
        input.value = "";
        isFirstSubmit = true;
        isBotTyping = false;
        if (stopBtn) stopBtn.style.display = "none";
      });
    }

    if (deleteChatBtn) {
      deleteChatBtn.addEventListener("click", () => {
        console.log("üóëÔ∏è Delete chat");
        clearSession();
        currentSessionId = getSessionId();
        chatCont.innerHTML = "";
        input.disabled = false;
        input.value = "";
        removeThinking();
      });
    }

    // ‚úÖ Clean URL parameters after processing
    if (urlParams.has('signed_in')) {
      const cleanUrl = window.location.origin + window.location.pathname;
      window.history.replaceState({}, document.title, cleanUrl);
    }

    console.log("‚úÖ Chatbot loaded with session ID:", currentSessionId);
  });
</script>
</body>
</html>
